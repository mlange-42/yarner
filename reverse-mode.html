<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reverse mode - Yarner Documentation</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="src/css/custom.css">
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Yarner -- Introduction</a></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">2.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="blocks-and-macros.html"><strong aria-hidden="true">3.</strong> Blocks and macros</a></li><li class="chapter-item expanded "><a href="multiple-code-files.html"><strong aria-hidden="true">4.</strong> Multiple code files</a></li><li class="chapter-item expanded "><a href="dead-and-hidden-code.html"><strong aria-hidden="true">5.</strong> Dead and hidden code</a></li><li class="chapter-item expanded "><a href="links-and-transclusions.html"><strong aria-hidden="true">6.</strong> Links and transclusions</a></li><li class="chapter-item expanded "><a href="copying-files.html"><strong aria-hidden="true">7.</strong> Copying files</a></li><li class="chapter-item expanded "><a href="reverse-mode.html" class="active"><strong aria-hidden="true">8.</strong> Reverse mode</a></li><li class="chapter-item expanded "><a href="watch-command.html"><strong aria-hidden="true">9.</strong> Watch command</a></li><li class="chapter-item expanded "><a href="plugins/plugins.html"><strong aria-hidden="true">10.</strong> Plugins</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="plugins/using.html"><strong aria-hidden="true">10.1.</strong> Using plugins</a></li><li class="chapter-item expanded "><a href="plugins/known.html"><strong aria-hidden="true">10.2.</strong> Known plugins</a></li><li class="chapter-item expanded "><a href="plugins/writing.html"><strong aria-hidden="true">10.3.</strong> Writing plugins</a></li></ol></li><li class="chapter-item expanded "><a href="configuration.html"><strong aria-hidden="true">11.</strong> Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="config-parser.html"><strong aria-hidden="true">11.1.</strong> Parser</a></li><li class="chapter-item expanded "><a href="config-paths.html"><strong aria-hidden="true">11.2.</strong> Paths</a></li><li class="chapter-item expanded "><a href="config-languages.html"><strong aria-hidden="true">11.3.</strong> Languages</a></li><li class="chapter-item expanded "><a href="command-line-arguments.html"><strong aria-hidden="true">11.4.</strong> Command line arguments</a></li></ol></li><li class="chapter-item expanded "><a href="advanced/advanced-topics.html"><strong aria-hidden="true">12.</strong> Advanced topics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="advanced/continuous-integration.html"><strong aria-hidden="true">12.1.</strong> Continuous integration</a></li><li class="chapter-item expanded "><a href="advanced/project-structure.html"><strong aria-hidden="true">12.2.</strong> Project structure</a></li><li class="chapter-item expanded "><a href="advanced/effective-markdown.html"><strong aria-hidden="true">12.3.</strong> Effective Markdown</a></li><li class="chapter-item expanded "><a href="advanced/mdbook.html"><strong aria-hidden="true">12.4.</strong> mdBook with Yarner</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Yarner Documentation</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/mlange-42/yarner" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="reverse-mode"><a class="header" href="#reverse-mode">Reverse mode</a></h1>
<p>Programming inside Markdown code blocks may be inconvenient due to missing syntax highlighting and the lack of IDE support in general.
Yarner offers a &quot;reverse mode&quot; that lets you edit generated code files, e.g. in an IDE, and to play back changes into the Markdown sources.</p>
<ul>
<li><a href="#usage">Usage</a></li>
<li><a href="#language-settings">Language settings</a></li>
<li><a href="#code-block-labels">Code block labels</a></li>
<li><a href="#copied-files">Copied files</a></li>
<li><a href="#lock-file">Lock file</a></li>
<li><a href="#clean-code-output">Clean code output</a></li>
<li><a href="#limitations">Limitations</a></li>
</ul>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<p>To use the reverse mode, run the following after making changes to generated code files:</p>
<pre><code class="language-plaintext">&gt; yarner reverse
</code></pre>
<p>Reverse mode requires settings for the target language(s) to be defined. See the following section.</p>
<h2 id="language-settings"><a class="header" href="#language-settings">Language settings</a></h2>
<p>To enable the reverse mode, Yarner needs to label code blocks in the generated sources to identify their origin.</p>
<p>The <code>Yarner.toml</code> file provides a section where settings for multiple languages can be specified. The language is determined from the extension of the output file. The following example provides settings for Rust that would be applied to all <code>.rs</code> files.</p>
<pre><code class="language-toml">[language.rs]
clear_blank_lines = true
eof_newline = true

    [language.rs.block_labels]
    comment_start = &quot;//&quot;
    # comment_end = &quot;*/&quot;
    block_start = &quot;&lt;@&quot;
    block_next = &quot;&lt;@&gt;&quot;
    block_end = &quot;@&gt;&quot;
</code></pre>
<p>In most cases, only the option <code>comment_start</code> needs to be adapted to the line comment sequence of the target language. E.g., Python requires the following:</p>
<pre><code class="language-toml">[language.py]
comment_start = &quot;#&quot;
...
</code></pre>
<p>Option <code>comment_end</code> is provided for languages that support only block comments and should be left out in all other cases.</p>
<p>For details on the available options, see chapter <a href="./config-languages.html">Languages</a>.</p>
<p>Multiple languages can be defined by simply adding one section per language.
It is, however, not necessary to provide language settings for every file extension present.
Files with no language settings for their extension are simply ignored during reverse mode.</p>
<h2 id="code-block-labels"><a class="header" href="#code-block-labels">Code block labels</a></h2>
<p>Code in output intended for the reverse mode is labelled to allow Yarner to identify its file and code block of origin. You can edit everything between labels, but do not modify or delete the labels themselves!</p>
<p>As an example, a simple Markdown source file <code>main.rs.md</code> could have the following content:</p>
<pre><code class="language-markdown"># Simple example

The program's entry point:

```rust
fn main() {
    // ==&gt; Say hello.
}
```

Here is how we say hello:

```rust
//- Say hello
println!(&quot;Hello World!&quot;);
```
</code></pre>
<p>With language settings for Rust as given above, the generated code in <code>main.rs</code> looks like this:</p>
<pre><code class="language-rust noplaypen">// &lt;@main.rs.md##0
fn main() {
    // &lt;@main.rs.md#Say hello#0
    println!(&quot;Hello World!&quot;);
    // @&gt;main.rs.md#Say hello#0
}
// @&gt;main.rs.md##0
</code></pre>
<h2 id="copied-files"><a class="header" href="#copied-files">Copied files</a></h2>
<p>If files were copied as explained in chapter <a href="./copying-files.html">Copying files</a>, Yarner detects these in reverse mode and copies them back. I.e. code in copied files can be modified just like code extracted from code blocks, but without the need to care for block labels.</p>
<h2 id="lock-file"><a class="header" href="#lock-file">Lock file</a></h2>
<p>When reverse mode for a project is enabled (by providing the required language settings), a file <code>Yarner.lock</code> is created in the project's <code>root</code>.
The file is required to prevent accidental overwrites of user edits in Markdown sources as well as code output.
E.g., after editing the code output, Yarner will refuse to do a forward build as your changes would then be lost.
To build the project nonetheless, run with option <code>--force</code>:</p>
<pre><code class="language-plaintext">&gt; yarner --force
&gt; yarner --force reverse
</code></pre>
<p>The file <code>Yarner.lock</code> should be ignored by Version Control Systems (i.e. add <code>Yarner.lock</code> to your <code>.gitignore</code>).</p>
<h2 id="clean-code-output"><a class="header" href="#clean-code-output">Clean code output</a></h2>
<p>For clean code output without block labels, run Yarner with option <code>--clean</code>:</p>
<pre><code class="language-plaintext">&gt; yarner --clean
</code></pre>
<p>Of course, the reverse mode does not work with clean output.</p>
<h2 id="limitations"><a class="header" href="#limitations">Limitations</a></h2>
<h3 id="block-repetitions"><a class="header" href="#block-repetitions">Block repetitions</a></h3>
<p>When the same code block is use by multiple macro invocations, it is ambiguous which one to play back into the sources. Here is an example:</p>
<pre><code class="language-rust noplaypen">fn main() {
    // ==&gt; Say hello.
    // ==&gt; Say hello.
}
</code></pre>
<p>In such cases, Yarner emits a warning when called with subcommand <code>reverse</code>. If the occurrences differ, like in the following example of user-modified code output, it aborts with an error.</p>
<pre><code class="language-rust noplaypen">// &lt;@main.rs.md#
fn main() {
    // &lt;@main.rs.md#Say hello#0
    println!(&quot;Hello World!&quot;);
    // @&gt;main.rs.md#Say hello#0
    // &lt;@main.rs.md#Say hello#0
    println!(&quot;Hello Universe!&quot;);
    // @&gt;main.rs.md#Say hello#0
}
// @&gt;main.rs.md#
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="copying-files.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="watch-command.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="copying-files.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="watch-command.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
